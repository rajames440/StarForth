% =====================================================
% window-scaling.tex
% Window scaling and resonance formulas
%
% This file can be:
% 1. Compiled standalone: pdflatex window-scaling.tex
% 2. Included in another document: \input{formulas/window-scaling.tex}
% =====================================================

\ifdefined\formulasincluded
\else
  \documentclass[11pt]{article}
  \usepackage{amsmath,amssymb,amsthm}
  \usepackage{booktabs}
  \usepackage[margin=1in]{geometry}
  \begin{document}
\fi

\subsection*{Window Scaling and Resonance}

\subsubsection*{Logarithmic Window Scaling}

Since window sizes vary as powers of 2, the appropriate coordinate is:

\begin{equation}
\xi = \log_2(W)
\label{eq:log_coordinate}
\end{equation}

James Law in logarithmic coordinates:

\begin{equation}
K(\xi) = \frac{\Lambda_{\text{eff}}}{2^\xi} \times \left[1 + A(2^\xi) \sin(2\pi f_0 \xi + \varphi)\right]
\label{eq:james_log}
\end{equation}

\subsubsection*{Resonance Detection}

Constructive interference maxima occur when:

\begin{equation}
\sin(2\pi f_0 \log_2(W) + \varphi) = 1
\label{eq:resonance_condition}
\end{equation}

Solving for resonance window sizes:

\begin{equation}
2\pi f_0 \log_2(W_{\text{res}}) + \varphi = \frac{\pi}{2} + 2\pi n, \quad n \in \mathbb{Z}
\label{eq:resonance_solve}
\end{equation}

\begin{equation}
\log_2(W_{\text{res}}) = \frac{1}{f_0}\left(\frac{1}{4} + n - \frac{\varphi}{2\pi}\right)
\label{eq:log_resonance}
\end{equation}

\begin{equation}
W_{\text{res}} = 2^{\frac{1}{f_0}\left(\frac{1}{4} + n - \frac{\varphi}{2\pi}\right)}
\label{eq:window_resonance}
\end{equation}

For $f_0 = 2/3$, $\varphi = 0$:

\begin{equation}
W_{\text{res}} = 2^{0.375 + 1.5n} = \{2^{0.375}, 2^{1.875}, 2^{3.375}, 2^{4.875}, \ldots\}
\label{eq:resonance_sequence}
\end{equation}

\begin{equation}
W_{\text{res}} \approx \{1.3, 3.7, 10.4, 29.4, 83.2, 235, 665, 1880, 5320, 15060, \ldots\} \text{ bytes (raw)}
\label{eq:resonance_raw}
\end{equation}

Rounding to practical power-of-2 or nearby values:

\begin{equation}
W_{\text{res}}^{\text{practical}} \approx \{1024, 4096, 6144, 16384, 32768, \ldots\}
\label{eq:resonance_practical}
\end{equation}

\subsubsection*{Anti-Resonance Detection}

Destructive interference (zeros) occur when:

\begin{equation}
\sin(2\pi f_0 \log_2(W) + \varphi) = 0
\label{eq:anti_resonance_condition}
\end{equation}

\begin{equation}
W_{\text{anti}} = 2^{\frac{n}{ f_0} - \frac{\varphi}{2\pi f_0}}
\label{eq:window_anti}
\end{equation}

For $f_0 = 2/3$, $\varphi = 0$:

\begin{equation}
W_{\text{anti}} \approx \{512, 2048, 8192, 32768, \ldots\}
\label{eq:anti_resonance_sizes}
\end{equation}

\subsubsection*{Golden Ratio Window Penalties}

Windows at odd multiples of powers of 2 exhibit $\varphi$-spaced cache penalties:

\begin{equation}
W_{\varphi} = 3 \times 2^N, \quad N \in \mathbb{Z}
\label{eq:phi_windows}
\end{equation}

Performance ratio at these windows:

\begin{equation}
r(W_{\varphi}) = \frac{P(W_{\varphi})}{P_{\text{baseline}}} \approx \varphi = 1.618 \pm 0.01
\label{eq:phi_penalty}
\end{equation}

\textbf{Forbidden window set (avoid due to $\varphi$-penalties):}

\begin{equation}
W_{\text{forbidden}} = \{1536, 3072, 6144, 12288, 24576, \ldots\} = \{3 \times 2^N : N \geq 9\}
\label{eq:forbidden_windows}
\end{equation}

\subsubsection*{Fibonacci Window Selection}

Fibonacci numbers naturally avoid $\varphi$-interference:

\begin{equation}
W_{\text{Fibonacci}} = \{F_k : k \geq 10\} = \{377, 610, 987, 1597, 2584, 4181, 6765, 10946, \ldots\}
\label{eq:fibonacci_windows}
\end{equation}

Fibonacci recurrence:

\begin{equation}
F_{k+1} = F_k + F_{k-1}, \quad F_0 = 0, F_1 = 1
\label{eq:fibonacci_recurrence}
\end{equation}

Limiting ratio:

\begin{equation}
\lim_{k \to \infty} \frac{F_{k+1}}{F_k} = \varphi = \frac{1 + \sqrt{5}}{2} = 1.618\ldots
\label{eq:fibonacci_limit}
\end{equation}

\subsubsection*{Approved Window Set}

Combining power-of-2, Fibonacci, and golden-ratio-power windows:

\begin{equation}
W_{\text{approved}} = \{2^N\} \cup \{F_k\} \cup \{\lfloor\varphi^n \times 256\rfloor\}
\label{eq:approved_windows}
\end{equation}

\subsubsection*{Harmonic Coupling (3:2 Ratio)}

Lissajous trajectory components:

\begin{align}
x(t) &= K(t) = A_K \sin(\omega_K t), \quad \omega_K = 2\pi f_K \label{eq:lissajous_x} \\
y(t) &= P(t) = A_P \sin(\omega_P t), \quad \omega_P = 2\pi f_P \label{eq:lissajous_y}
\end{align}

Frequency ratio (perfect fifth in music):

\begin{equation}
\frac{f_P}{f_K} = \frac{1.0}{0.6667} = \frac{3}{2}
\label{eq:harmonic_ratio}
\end{equation}

Trajectory closes after 3 K-oscillations (2 P-oscillations).

\subsubsection*{FFT Analysis}

Fast Fourier Transform procedure for frequency measurement:

\begin{enumerate}
\item Compute baseline: $K_{\text{base}}(W) = 256 / W$
\item Extract residuals: $R_i = K_{\text{obs},i} - K_{\text{base},i}$
\item Apply FFT to $R(\log_2(W))$
\item Identify dominant frequency peak
\end{enumerate}

\textbf{Result:}

\begin{equation}
f_0 = \text{argmax}_f \left|\text{FFT}(R(\log_2(W)))\right| = 0.6667 \pm 0.02 \text{ cycles/window}
\label{eq:fft_result}
\end{equation}

with spectral power 15Ã— above noise floor ($p < 0.0001$).

\subsubsection*{Period and Wavelength}

Period in logarithmic space:

\begin{equation}
T_{\log} = \frac{1}{f_0} = \frac{1}{2/3} = 1.5 \text{ window doublings}
\label{eq:period_log}
\end{equation}

Physical wavelength:

\begin{equation}
\lambda_{\text{phys}} = \frac{2\pi}{k} = \lambda_0 = 256 \text{ bytes}
\label{eq:wavelength_physical}
\end{equation}

\subsubsection*{Amplitude Envelope Scaling}

Exponential damping with window size:

\begin{equation}
A(W) = A_{\max} \exp\left(-\frac{W}{W_{\text{decay}}}\right)
\label{eq:amplitude_envelope}
\end{equation}

Fitted parameters:
\begin{itemize}
\item $A_{\max} = 0.3 \pm 0.02$
\item $W_{\text{decay}} = 50000 \pm 5000$ bytes
\end{itemize}

Half-amplitude window size:

\begin{equation}
W_{1/2} = W_{\text{decay}} \ln(2) \approx 34657 \text{ bytes}
\label{eq:half_amplitude}
\end{equation}

\ifdefined\formulasincluded
\else
  \end{document}
\fi
